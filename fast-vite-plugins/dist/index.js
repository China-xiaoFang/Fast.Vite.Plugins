import A from"fs";import D from"path";var T=t=>{let n=[];return A.readdirSync(t,{withFileTypes:!0}).forEach(r=>{if(r.isDirectory())n.push(...T(D.join(t,r.name)));else{let i=r.name.replace(".svg",""),f=A.readFileSync(D.join(t,r.name),"utf-8").replace(/<\?xml.*?\?>/,"").replace(/<!DOCTYPE svg.*?>/,"").trimStart().trimEnd().replace(/<svg([^>+].*?)>/,(p,u)=>{let s=u.match(/viewBox="[^"]+"/),v=u.match(/width="(\d+)"/),l=u.match(/height="(\d+)"/),x=1024,h=1024;v&&(x=v[0]),l&&(h=l[0]);let C="";return s?C=s[0]:C=`viewBox="0 0 ${x} ${h}"`,`<svg xmlns="http://www.w3.org/2000/svg" ${C}>`});n.push({iconName:i,componentName:i.charAt(0).toUpperCase()+i.slice(1),iconContent:f})}}),n.sort((r,i)=>r.iconName<i.iconName?-1:r.iconName>i.iconName?1:0)},O=(t,n,o)=>{A.mkdirSync(n,{recursive:!0});let r=`import { defineComponent } from "vue";

/**
 * ${t} \u56FE\u6807\u7EC4\u4EF6
 */
export const ${t} = defineComponent({
	name: "${t}",
	render() {
		return (
${o.split(`
`).map(i=>`			${i}`).join(`
`)}
		);
	},
});

export default ${t};
`;A.writeFileSync(D.join(n,"index.tsx"),r)};function X(t,n){if(!t||!n)return;let o;return{name:"fast-vite-plugin-build-svg-icon",configResolved:r=>{o=r},buildStart(){let r=T(D.resolve(o.root,t)),i=D.resolve(o.root,n);A.mkdirSync(i,{recursive:!0});let f="",p="",u="";r.forEach((s,v)=>{O(s.componentName,D.join(i,s.iconName),s.iconContent),f+=`import { ${s.componentName} } from "./${s.iconName}";
`,p+=`	${s.componentName},`,u+=`export * from "./${s.iconName}";
`,v+1<r.length&&(p+=`
`)}),A.writeFileSync(D.join(i,"index.ts"),`import type { DefineComponent } from "vue";
${f}
${u}
export default [
${p}
] as unknown as DefineComponent[];
`)}}}import E from"fs";import W from"path";import J from"rollup-plugin-external-globals";import{viteExternalsPlugin as L}from"vite-plugin-externals";var _=process.env.NODE_ENV==="development";function B(t){let n=process.cwd(),o=W.join(n,"node_modules",t,"package.json");return E.existsSync(o)?JSON.parse(E.readFileSync(o,"utf8")).version:""}function M(t){return!!(t.startsWith("http:")||t.startsWith("https:")||t.startsWith("//"))}function U(t,n){let{path:o}=n;return M(o)&&(t=o),t.replace(/\{name\}/g,n.name).replace(/\{version\}/g,n.version).replace(/\{path\}/g,o)}function G(t,n){n=t.prodUrl||n;let o=t,r=t.version||B(o.name),i=[];Array.isArray(o.path)?i=o.path:i.push(o.path);let f={...o,version:r};i=i.map(s=>{if(!r&&!M(s))throw new Error(`modules: ${f.name} package.json file does not exist`);return U(n,{name:f.name,version:f.version,path:s})});let p=o.css||[];!Array.isArray(p)&&p&&(p=[p]);let u=Array.isArray(p)?p.map(s=>U(n,{name:f.name,version:f.version,path:s})):[];return{...o,version:r,pathList:i,cssList:u}}var H="https://cdn.jsdelivr.net/npm/{name}@{version}/{path}",nt="https://unpkg.com/{package}@{version}/{path}";function ot(t){let{modules:n=[],prodUrl:o=H,enableInDevMode:r=!1,generateCssLinkTag:i,generateScriptTag:f}=t,p=!1,u=(Array.isArray(n)?n:[n]).map(l=>typeof l=="function"?l(o):l).map(l=>G(l,o)),s={};u.forEach(l=>{s[l.name]=l.var,Array.isArray(l.alias)&&l.alias.forEach(x=>{s[x]=l.var})});let v=[{name:"fast-vite-plugin-cdn-import",enforce:"pre",config(l,{command:x}){p=x==="build";let h={build:{rollupOptions:{plugins:[]}}};return p&&(h.build.rollupOptions.plugins=[J(s)]),h},transformIndexHtml(l){if(!p&&!r)return l;let x=[];return u.forEach(h=>{h.pathList.forEach(C=>{let w=f?.(h.name,C)||{},F={src:C,crossorigin:"anonymous",...h?.attrs??{},...w.attrs};x.push({tag:"script",attrs:F,...w})}),h.cssList.forEach(C=>{let w=i?.(h.name,C)||{},F={href:C,rel:"stylesheet",crossorigin:"anonymous",...h?.attrs??{},...w.attrs};x.push({tag:"link",attrs:F,...w})})}),x}}];return _&&r&&v.push(L(s,{enforce:"pre"})),v}import y from"fs";import S from"path";function I(t){return t.replace(/\\/g,"/")}function V(t){return t.replace(/[-_](\w)/g,(n,o)=>o?o.toUpperCase():"").replace(/^\w/,n=>n.toUpperCase())}function ct(t={}){let{dir:n="src/components",exportPath:o="src/components/index.ts",dts:r=!0,dtsPath:i="types/component.d.ts",deep:f=!0,extensions:p=["vue","tsx","jsx"],formatter:u}=t,s,v=new Map,l=null,x=m=>{let c=m;for(let a of p)if(c.endsWith(`.${a}`)){c=c.slice(0,-a.length-1);break}if(c.endsWith("/index")||c.endsWith("\\index")){let a=c.split(/[\\/]/);c=a[a.length-2]||a[a.length-1]}else{let a=c.split(/[\\/]/);c=a[a.length-1]}return u?u(c):V(c)},h=(m,c=0)=>{let a=[];if(!y.existsSync(m))return a;let e=y.readdirSync(m,{withFileTypes:!0});for(let g of e){let b=S.join(m,g.name);if(g.isDirectory()){if(g.name==="node_modules"||g.name.startsWith(". "))continue;(f||c===0)&&a.push(...h(b,c+1))}else if(g.isFile()){let d=S.extname(g.name).slice(1);p.includes(d)&&a.push(b)}}return a},C=()=>{v.clear();let m=S.resolve(s.root,n);if(!y.existsSync(m)){console.warn(`[component-auto-import] Directory not found: ${m}`);return}h(m).forEach(a=>{let e=S.relative(m,a),g=x(e);v.set(g,{name:g,from:a})})},w=()=>{if(v.size===0)return;let m=Array.from(v.values()).sort((d,P)=>d.name.localeCompare(P.name)),c=S.resolve(s.root,o),a=S.dirname(c),e=[];e.push("/* eslint-disable */"),e.push("/* prettier-ignore */"),e.push("// @ts-nocheck"),e.push("// Auto-generated by fast component-auto-import"),e.push("// Generated by fast-vite-plugins"),e.push("// Do not edit this file manually"),e.push(""),e.push('import type { App } from "vue";'),e.push(""),m.forEach(({name:d,from:P})=>{let $=I(S.relative(a,P)),k=$.startsWith(".")?$:`./${$}`;e.push(`import ${d} from "${k}";`),e.push(`export { ${d} };`),e.push(`export type ${d}Instance = InstanceType<typeof ${d}>;`)}),e.push(""),e.push("/** \u81EA\u52A8\u6CE8\u518C\u6240\u6709\u7EC4\u4EF6 */"),e.push("export function registerComponents(app: App): void {"),m.forEach(({name:d})=>{e.push(`	app.component(${d}.name, ${d});`)}),e.push("}"),e.push("");let g=`${e.join(`
`)}
`,b=y.existsSync(c)?y.readFileSync(c,"utf-8"):"";g!==b&&y.writeFileSync(c,g,"utf-8")},F=()=>{if(!r||v.size===0)return;let m=Array.from(v.values()).sort((d,P)=>d.name.localeCompare(P.name)),c=S.resolve(s.root,i),a=S.dirname(c),e=[];e.push("// For this project development"),e.push("// Auto-generated by fast component-auto-import"),e.push("// Generated by fast-vite-plugins"),e.push("// Do not edit this file manually"),e.push(""),e.push('import "@vue/runtime-core";'),e.push(""),e.push("// GlobalComponents for Volar"),e.push('declare module "@vue/runtime-core" {'),e.push("	export interface GlobalComponents {"),m.forEach(({name:d,from:P})=>{let $=I(S.relative(a,P));$=$.replace(/\.(vue|tsx|jsx)$/,"");let k=$.startsWith(".")?$:`./${$}`;e.push(`		${d}: (typeof import("${k}"))["default"];`)}),e.push("	}"),e.push("}"),e.push(""),e.push("export {};");let g=`${e.join(`
`)}
`;y.existsSync(a)||y.mkdirSync(a,{recursive:!0});let b=y.existsSync(c)?y.readFileSync(c,"utf-8"):"";g!==b&&y.writeFileSync(c,g,"utf-8")};return{name:"fast-vite-plugin-component-auto-import",enforce:"post",configResolved:m=>{s=m},buildStart(){C(),w(),F()},configureServer(m){let c=S.resolve(s.root,n);y.existsSync(c)&&(l=y.watch(c,{recursive:!0},(a,e)=>{if(!e||e.endsWith(".d.ts"))return;let g=S.extname(e).slice(1);p.includes(g)&&(C(),w(),F(),m.ws.send({type:"full-reload",path:"*"}))}))},buildEnd(){l&&(l.close(),l=null)}}}import N from"fs";import R from"path";function j(t,n=2){return t.toString().padStart(n,"0")}function z(t){let n=t.getUTCFullYear(),o=j(t.getUTCMonth()+1),r=j(t.getUTCDate()),i=j(t.getUTCHours()),f=j(t.getUTCMinutes()),p=j(t.getUTCSeconds()),u=j(t.getUTCMilliseconds(),3);return`Z ${n}-${o}-${r} ${i}:${f}:${p}.${u}`}function ut(t){let n;return{name:"fast-vite-plugin-version-update",configResolved:o=>{n=o},buildStart(){let r=z(new Date),i=n.publicDir,f=R.join(i,"version.json");N.existsSync(i)||N.mkdirSync(i);let p=JSON.stringify({version:`v${t}`,dateTime:r},null,4);N.writeFileSync(f,p);let u=R.join(n.base,"package.json");if(N.existsSync(u)){let s=JSON.parse(N.readFileSync(u,"utf-8"));s.version=t,N.writeFileSync(u,JSON.stringify(s,null,2),"utf-8")}}}}export{X as buildSvgIcon,ot as cdnImport,H as cdnJsDelivrUrl,nt as cdnUnpkgUrl,ct as componentAutoImport,T as findSvgFile,ut as versionUpdatePlugin,O as writeTSXIcon};
//# sourceMappingURL=index.js.map