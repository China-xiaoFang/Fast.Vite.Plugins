import A from"fs";import j from"path";var T=t=>{let n=[];return A.readdirSync(t,{withFileTypes:!0}).forEach(a=>{if(a.isDirectory())n.push(...T(j.join(t,a.name)));else{let c=a.name.replace(".svg",""),g=A.readFileSync(j.join(t,a.name),"utf-8").replace(/<\?xml.*?\?>/,"").replace(/<!DOCTYPE svg.*?>/,"").trimStart().trimEnd().replace(/<svg([^>+].*?)>/,(p,u)=>{let s=u.match(/viewBox="[^"]+"/),C=u.match(/width="(\d+)"/),i=u.match(/height="(\d+)"/),d=1024,h=1024;C&&(d=C[0]),i&&(h=i[0]);let f="";return s?f=s[0]:f=`viewBox="0 0 ${d} ${h}"`,`<svg xmlns="http://www.w3.org/2000/svg" ${f}>`});n.push({iconName:c,componentName:c.charAt(0).toUpperCase()+c.slice(1),iconContent:g})}}),n.sort((a,c)=>a.iconName<c.iconName?-1:a.iconName>c.iconName?1:0)},J=(t,n,o)=>{A.mkdirSync(n,{recursive:!0});let a=`import { defineComponent } from "vue";

/**
 * ${t} \u56FE\u6807\u7EC4\u4EF6
 */
export const ${t} = defineComponent({
	name: "${t}",
	render() {
		return (
${o.split(`
`).map(c=>`			${c}`).join(`
`)}
		);
	},
});

export default ${t};
`;A.writeFileSync(j.join(n,"index.tsx"),a)};function tt(t,n){if(!t||!n)return;let o;return{name:"fast-vite-plugin-build-svg-icon",configResolved:a=>{o=a},buildStart(){let a=T(j.resolve(o.root,t)),c=j.resolve(o.root,n);A.mkdirSync(c,{recursive:!0});let g="",p="",u="";a.forEach((s,C)=>{J(s.componentName,j.join(c,s.iconName),s.iconContent),g+=`import { ${s.componentName} } from "./${s.iconName}";
`,p+=`	${s.componentName},`,u+=`export * from "./${s.iconName}";
`,C+1<a.length&&(p+=`
`)}),A.writeFileSync(j.join(c,"index.ts"),`import type { DefineComponent } from "vue";
${g}
${u}
export default [
${p}
] as unknown as DefineComponent[];
`)}}}import U from"fs";import _ from"path";import B from"rollup-plugin-external-globals";import{viteExternalsPlugin as V}from"vite-plugin-externals";var G=process.env.NODE_ENV==="development";function H(t){let n=process.cwd(),o=_.join(n,"node_modules",t,"package.json");return U.existsSync(o)?JSON.parse(U.readFileSync(o,"utf8")).version:""}function O(t){return!!(t.startsWith("http:")||t.startsWith("https:")||t.startsWith("//"))}function M(t,n){let{path:o}=n;return O(o)&&(t=o),t.replace(/\{name\}/g,n.name).replace(/\{version\}/g,n.version).replace(/\{path\}/g,o)}function z(t,n){n=t.prodUrl||n;let o=t,a=t.version||H(o.name),c=[];Array.isArray(o.path)?c=o.path:c.push(o.path);let g={...o,version:a};c=c.map(s=>{if(!a&&!O(s))throw new Error(`modules: ${g.name} package.json file does not exist`);return M(n,{name:g.name,version:g.version,path:s})});let p=o.css||[];!Array.isArray(p)&&p&&(p=[p]);let u=Array.isArray(p)?p.map(s=>M(n,{name:g.name,version:g.version,path:s})):[];return{...o,version:a,pathList:c,cssList:u}}var L="https://cdn.jsdelivr.net/npm/{name}@{version}/{path}",it="https://unpkg.com/{package}@{version}/{path}";function ct(t){let{modules:n=[],prodUrl:o=L,enableInDevMode:a=!1,generateCssLinkTag:c,generateScriptTag:g}=t,p=!1,u=(Array.isArray(n)?n:[n]).map(i=>typeof i=="function"?i(o):i).map(i=>z(i,o)),s={};u.forEach(i=>{s[i.name]=i.var,Array.isArray(i.alias)&&i.alias.forEach(d=>{s[d]=i.var})});let C=[{name:"fast-vite-plugin-cdn-import",enforce:"pre",config(i,{command:d}){p=d==="build";let h={build:{rollupOptions:{plugins:[]}}};return p&&(h.build.rollupOptions.plugins=[B(s)]),h},transformIndexHtml(i){if(!p&&!a)return i;let d=[];return u.forEach(h=>{h.pathList.forEach(f=>{let y=g?.(h.name,f)||{},D={src:f,crossorigin:"anonymous",...h?.attrs??{},...y.attrs};d.push({tag:"script",attrs:D,...y})}),h.cssList.forEach(f=>{let y=c?.(h.name,f)||{},D={href:f,rel:"stylesheet",crossorigin:"anonymous",...h?.attrs??{},...y.attrs};d.push({tag:"link",attrs:D,...y})})}),d}}];return G&&a&&C.push(V(s,{enforce:"pre"})),C}import S from"fs";import $ from"path";function I(t){return t.replace(/\\/g,"/")}function Y(t){return t.replace(/[-_](\w)/g,(n,o)=>o?o.toUpperCase():"").replace(/^\w/,n=>n.toUpperCase())}function ut(t={}){let{dir:n="src/components",exportPath:o="src/components/index.ts",dts:a=!0,dtsPath:c="types/component.d.ts",deep:g=!0,extensions:p=["vue","tsx","jsx"],formatter:u}=t,s,C=new Map,i=null,d=m=>{let r=m;for(let l of p)if(r.endsWith(`.${l}`)){r=r.slice(0,-l.length-1);break}if(r.endsWith("/index")||r.endsWith("\\index")){let l=r.split(/[\\/]/);r=l[l.length-2]||l[l.length-1]}else{let l=r.split(/[\\/]/);r=l[l.length-1]}return u?u(r):Y(r)},h=(m,r=0)=>{let l=[];if(!S.existsSync(m))return l;let e=S.readdirSync(m,{withFileTypes:!0});for(let v of e){let w=$.join(m,v.name);if(v.isDirectory()){if(v.name==="node_modules"||v.name.startsWith(". "))continue;(g||r===0)&&l.push(...h(w,r+1))}else if(v.isFile()){let x=$.extname(v.name).slice(1);p.includes(x)&&l.push(w)}}return l},f=()=>{C.clear();let m=$.resolve(s.root,n);if(!S.existsSync(m)){console.warn(`[component-auto-import] Directory not found: ${m}`);return}h(m).forEach(l=>{let e=$.relative(m,l),v=d(e);C.set(v,{name:v,from:l})})},y=()=>{if(C.size===0)return;let m=Array.from(C.values()).sort((x,b)=>x.name.localeCompare(b.name)),r=$.resolve(s.root,o),l=$.dirname(r),e=[];e.push("/* eslint-disable */"),e.push("/* prettier-ignore */"),e.push("// @ts-nocheck"),e.push("// Auto-generated by fast component-auto-import"),e.push("// Generated by fast-vite-plugins"),e.push("// Do not edit this file manually"),e.push(""),e.push('import type { App } from "vue";'),e.push(""),m.forEach(({name:x,from:b})=>{let F=I($.relative(l,b)),E=F.startsWith(".")?F:`./${F}`;e.push(`import ${x} from "${E}";`),e.push(`export { ${x} };`),e.push(`export type ${x}Instance = InstanceType<typeof ${x}>;`)}),e.push(""),e.push("/** \u81EA\u52A8\u6CE8\u518C\u6240\u6709\u7EC4\u4EF6 */"),e.push("export function registerComponents(app: App): void {"),m.forEach(({name:x})=>{e.push(`	app.component(${x}.name, ${x});`)}),e.push("}"),e.push("");let v=`${e.join(`
`)}
`,w=S.existsSync(r)?S.readFileSync(r,"utf-8"):"";v!==w&&S.writeFileSync(r,v,"utf-8")},D=()=>{if(!a||C.size===0)return;let m=Array.from(C.values()).sort((x,b)=>x.name.localeCompare(b.name)),r=$.resolve(s.root,c),l=$.dirname(r),e=[];e.push("// For this project development"),e.push("// Auto-generated by fast component-auto-import"),e.push("// Generated by fast-vite-plugins"),e.push("// Do not edit this file manually"),e.push(""),e.push('import "@vue/runtime-core";'),e.push(""),e.push("// GlobalComponents for Volar"),e.push('declare module "@vue/runtime-core" {'),e.push("	export interface GlobalComponents {"),m.forEach(({name:x,from:b})=>{let F=I($.relative(l,b));F=F.replace(/\.(vue|tsx|jsx)$/,"");let E=F.startsWith(".")?F:`./${F}`;e.push(`		${x}: (typeof import("${E}"))["default"];`)}),e.push("	}"),e.push("}"),e.push(""),e.push("export {};");let v=`${e.join(`
`)}
`;S.existsSync(l)||S.mkdirSync(l,{recursive:!0});let w=S.existsSync(r)?S.readFileSync(r,"utf-8"):"";v!==w&&S.writeFileSync(r,v,"utf-8")};return{name:"fast-vite-plugin-component-auto-import",enforce:"post",configResolved:m=>{s=m},buildStart(){f(),y(),D()},configureServer(m){let r=$.resolve(s.root,n);S.existsSync(r)&&(i=S.watch(r,{recursive:!0},(l,e)=>{if(!e||e.endsWith(".d.ts"))return;let v=$.extname(e).slice(1);p.includes(v)&&(f(),y(),D(),m.ws.send({type:"full-reload",path:"*"}))}))},buildEnd(){i&&(i.close(),i=null)}}}import N from"fs";import P from"path";function Z(t){return t.replace(/[-_](\w)/g,(n,o)=>o?o.toUpperCase():"").replace(/^\w/,n=>n.toUpperCase())}function X(t){let n=/defineOptions\(\s*\{\s*name:\s*["']([^"']+)["']/,o=t.match(n);return o?o[1]:null}function dt(t={}){let{dir:n="src/views",exportPath:o="src/router/index.json",deep:a=!0,extensions:c=["vue","tsx","jsx"],formatter:g}=t,p,u=null,s=(i,d=[])=>(N.existsSync(i)&&N.readdirSync(i).forEach(f=>{let y=P.join(i,f);if(N.statSync(y).isDirectory())a&&s(y,d);else{let m=P.extname(y).slice(1);c.includes(m)&&d.push(y)}}),d),C=()=>{let i=P.resolve(p.root,n),h=s(i).reduce((m,r)=>{try{let l=N.readFileSync(r,"utf-8"),e=X(l),v=`/${P.relative(p.root,r).replace(/\\/g,"/")}`,w;if(e)w=e;else{let x=P.basename(r,P.extname(r));w=g?g(x):Z(x)}m[v]=w}catch(l){console.error(`Error processing file ${r}:`,l)}return m},{}),f=P.resolve(p.root,o),y=P.dirname(f);N.existsSync(y)||N.mkdirSync(y,{recursive:!0});let D=JSON.stringify(h,null,2);N.writeFileSync(f,D,"utf-8")};return{name:"fast-vite-plugin-router-path",enforce:"post",configResolved:i=>{p=i},buildStart(){C()},configureServer(i){let d=P.resolve(p.root,n);N.existsSync(d)&&(u=N.watch(d,{recursive:!0},(h,f)=>{if(!f||f.endsWith(".d.ts")||f.endsWith(".json"))return;let y=P.extname(f).slice(1);c.includes(y)&&(C(),i.ws.send({type:"full-reload",path:"*"}))}))},buildEnd(){u&&(u.close(),u=null)}}}import R from"fs";import W from"path";function k(t,n=2){return t.toString().padStart(n,"0")}function q(t){let n=t.getUTCFullYear(),o=k(t.getUTCMonth()+1),a=k(t.getUTCDate()),c=k(t.getUTCHours()),g=k(t.getUTCMinutes()),p=k(t.getUTCSeconds()),u=k(t.getUTCMilliseconds(),3);return`Z ${n}-${o}-${a} ${c}:${g}:${p}.${u}`}function xt(t){let n;return{name:"fast-vite-plugin-version-update",configResolved:o=>{n=o},buildStart(){let a=q(new Date),c=n.publicDir,g=W.join(c,"version.json");R.existsSync(c)||R.mkdirSync(c);let p=JSON.stringify({version:`v${t}`,dateTime:a},null,4);R.writeFileSync(g,p);let u=W.join(n.base,"package.json");if(R.existsSync(u)){let s=JSON.parse(R.readFileSync(u,"utf-8"));s.version=t,R.writeFileSync(u,JSON.stringify(s,null,2),"utf-8")}}}}export{dt as buildRouterPath,tt as buildSvgIcon,ct as cdnImport,L as cdnJsDelivrUrl,it as cdnUnpkgUrl,ut as componentAutoImport,T as findSvgFile,xt as versionUpdatePlugin,J as writeTSXIcon};
//# sourceMappingURL=index.js.map