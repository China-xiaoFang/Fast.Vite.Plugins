"use strict";var L=Object.create;var E=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var X=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var K=(t,e)=>{for(var n in e)E(t,n,{get:e[n],enumerable:!0})},I=(t,e,n,p)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Z(e))!q.call(t,r)&&r!==n&&E(t,r,{get:()=>e[r],enumerable:!(p=Y(e,r))||p.enumerable});return t};var $=(t,e,n)=>(n=t!=null?L(X(t)):{},I(e||!t||!t.__esModule?E(n,"default",{value:t,enumerable:!0}):n,t)),Q=t=>I(E({},"__esModule",{value:!0}),t);var ft={};K(ft,{buildRouterPath:()=>lt,buildSvgIcon:()=>tt,cdnImport:()=>st,cdnJsDelivrUrl:()=>H,cdnUnpkgUrl:()=>rt,componentAutoImport:()=>ct,findSvgFile:()=>U,versionUpdatePlugin:()=>mt,writeTSXIcon:()=>W});module.exports=Q(ft);var j=$(require("fs"),1),N=$(require("path"),1),U=t=>{let e=[];return j.default.readdirSync(t,{withFileTypes:!0}).forEach(p=>{if(p.isDirectory())e.push(...U(N.default.join(t,p.name)));else{let r=p.name.replace(".svg",""),g=j.default.readFileSync(N.default.join(t,p.name),"utf-8").replace(/<\?xml.*?\?>/,"").replace(/<!DOCTYPE svg.*?>/,"").trimStart().trimEnd().replace(/<svg([^>+].*?)>/,(c,m)=>{let f=m.match(/viewBox="[^"]+"/),i=m.match(/width="(\d+)"/),u=m.match(/height="(\d+)"/),v=1024,d=1024;i&&(v=i[0]),u&&(d=u[0]);let h="";return f?h=f[0]:h=`viewBox="0 0 ${v} ${d}"`,`<svg xmlns="http://www.w3.org/2000/svg" ${h}>`});e.push({iconName:r,componentName:r.charAt(0).toUpperCase()+r.slice(1),iconContent:g})}}),e.sort((p,r)=>p.iconName<r.iconName?-1:p.iconName>r.iconName?1:0)},W=(t,e,n)=>{j.default.mkdirSync(e,{recursive:!0});let p=`import { defineComponent } from "vue";

/**
 * ${t} \u56FE\u6807\u7EC4\u4EF6
 */
export const ${t} = defineComponent({
	name: "${t}",
	render() {
		return (
${n.split(`
`).map(r=>`			${r}`).join(`
`)}
		);
	},
});

export default ${t};
`;j.default.writeFileSync(N.default.join(e,"index.tsx"),p)};function tt(t,e){if(!t||!e)return;let n,p=()=>{let r=U(N.default.resolve(n.root,t)),g=N.default.resolve(n.root,e);j.default.mkdirSync(g,{recursive:!0});let c="",m="",f="";r.forEach((i,u)=>{W(i.componentName,N.default.join(g,i.iconName),i.iconContent),c+=`import { ${i.componentName} } from "./${i.iconName}";
`,m+=`	${i.componentName},`,f+=`export * from "./${i.iconName}";
`,u+1<r.length&&(m+=`
`)}),j.default.writeFileSync(N.default.join(g,"index.ts"),`import type { DefineComponent } from "vue";
${c}
${f}
export default [
${m}
] as unknown as DefineComponent[];
`)};return{name:"fast-vite-plugin-build-svg-icon",configResolved:r=>{n=r},buildStart(){p()},configureServer(r){let g=N.default.resolve(n.root,t);if(j.default.existsSync(g)){r.watcher.add(g);let c=m=>{m&&m.endsWith(".svg")&&p()};r.watcher.on("add",c),r.watcher.on("change",c),r.watcher.on("unlink",c)}}}}var M=$(require("fs"),1),V=$(require("path"),1),_=$(require("rollup-plugin-external-globals"),1),B=require("vite-plugin-externals"),et=process.env.NODE_ENV==="development";function nt(t){let e=process.cwd(),n=V.default.join(e,"node_modules",t,"package.json");return M.default.existsSync(n)?JSON.parse(M.default.readFileSync(n,"utf8")).version:""}function G(t){return!!(t.startsWith("http:")||t.startsWith("https:")||t.startsWith("//"))}function J(t,e){let{path:n}=e;return G(n)&&(t=n),t.replace(/\{name\}/g,e.name).replace(/\{version\}/g,e.version).replace(/\{path\}/g,n)}function ot(t,e){e=t.prodUrl||e;let n=t,p=t.version||nt(n.name),r=[];Array.isArray(n.path)?r=n.path:r.push(n.path);let g={...n,version:p};r=r.map(f=>{if(!p&&!G(f))throw new Error(`modules: ${g.name} package.json file does not exist`);return J(e,{name:g.name,version:g.version,path:f})});let c=n.css||[];!Array.isArray(c)&&c&&(c=[c]);let m=Array.isArray(c)?c.map(f=>J(e,{name:g.name,version:g.version,path:f})):[];return{...n,version:p,pathList:r,cssList:m}}var H="https://cdn.jsdelivr.net/npm/{name}@{version}/{path}",rt="https://unpkg.com/{package}@{version}/{path}";function st(t){let{modules:e=[],prodUrl:n=H,enableInDevMode:p=!1,generateCssLinkTag:r,generateScriptTag:g}=t,c=!1,m=(Array.isArray(e)?e:[e]).map(u=>typeof u=="function"?u(n):u).map(u=>ot(u,n)),f={};m.forEach(u=>{f[u.name]=u.var,Array.isArray(u.alias)&&u.alias.forEach(v=>{f[v]=u.var})});let i=[{name:"fast-vite-plugin-cdn-import",enforce:"pre",config(u,{command:v}){c=v==="build";let d={build:{rollupOptions:{plugins:[]}}};return c&&(d.build.rollupOptions.plugins=[(0,_.default)(f)]),d},transformIndexHtml(u){if(!c&&!p)return u;let v=[];return m.forEach(d=>{d.pathList.forEach(h=>{let w=g?.(d.name,h)||{},l={src:h,crossorigin:"anonymous",...d?.attrs??{},...w.attrs};v.push({tag:"script",attrs:l,...w})}),d.cssList.forEach(h=>{let w=r?.(d.name,h)||{},l={href:h,rel:"stylesheet",crossorigin:"anonymous",...d?.attrs??{},...w.attrs};v.push({tag:"link",attrs:l,...w})})}),v}}];return et&&p&&i.push((0,B.viteExternalsPlugin)(f,{enforce:"pre"})),i}var S=$(require("fs"),1),C=$(require("path"),1);function z(t){return t.replace(/\\/g,"/")}function it(t){return t.replace(/[-_](\w)/g,(e,n)=>n?n.toUpperCase():"").replace(/^\w/,e=>e.toUpperCase())}function ct(t={}){let{dir:e="src/components",exportPath:n="src/components/index.ts",dts:p=!0,dtsPath:r="types/components.d.ts",deep:g=!0,extensions:c=["vue","tsx","jsx"],formatter:m}=t,f,i=new Map,u=l=>{let s=l;for(let a of c)if(s.endsWith(`.${a}`)){s=s.slice(0,-a.length-1);break}if(s.endsWith("/index")||s.endsWith("\\index")){let a=s.split(/[\\/]/);s=a[a.length-2]||a[a.length-1]}else{let a=s.split(/[\\/]/);s=a[a.length-1]}return m?m(s):it(s)},v=(l,s=0)=>{let a=[];if(!S.default.existsSync(l))return a;let o=S.default.readdirSync(l,{withFileTypes:!0});for(let y of o){let P=C.default.join(l,y.name);if(y.isDirectory()){if(y.name==="node_modules"||y.name.startsWith(". "))continue;(g||s===0)&&a.push(...v(P,s+1))}else if(y.isFile()){let x=C.default.extname(y.name).slice(1);c.includes(x)&&a.push(P)}}return a},d=()=>{i.clear();let l=C.default.resolve(f.root,e);if(!S.default.existsSync(l)){console.warn(`[component-auto-import] Directory not found: ${l}`);return}v(l).forEach(a=>{let o=C.default.relative(l,a),y=u(o);i.set(y,{name:y,from:a})})},h=()=>{if(i.size===0)return;let l=Array.from(i.values()).sort((x,k)=>x.name.localeCompare(k.name)),s=C.default.resolve(f.root,n),a=C.default.dirname(s),o=[];o.push("/* eslint-disable */"),o.push("/* prettier-ignore */"),o.push("// @ts-nocheck"),o.push("// Auto-generated by fast component-auto-import"),o.push("// Generated by fast-vite-plugins"),o.push("// Do not edit this file manually"),o.push(""),o.push('import type { App } from "vue";'),o.push(""),l.forEach(({name:x,from:k})=>{let F=z(C.default.relative(a,k)),T=F.startsWith(".")?F:`./${F}`;o.push(`import ${x} from "${T}";`),o.push(`export { ${x} };`),o.push(`export type ${x}Instance = InstanceType<typeof ${x}>;`)}),o.push(""),o.push("/** \u81EA\u52A8\u6CE8\u518C\u6240\u6709\u7EC4\u4EF6 */"),o.push("export function registerComponents(app: App): void {"),l.forEach(({name:x})=>{o.push(`	app.component(${x}.name, ${x});`)}),o.push("}"),o.push("");let y=`${o.join(`
`)}
`,P=S.default.existsSync(s)?S.default.readFileSync(s,"utf-8"):"";y!==P&&S.default.writeFileSync(s,y,"utf-8")},w=()=>{if(!p||i.size===0)return;let l=Array.from(i.values()).sort((x,k)=>x.name.localeCompare(k.name)),s=C.default.resolve(f.root,r),a=C.default.dirname(s),o=[];o.push("// For this project development"),o.push("// Auto-generated by fast component-auto-import"),o.push("// Generated by fast-vite-plugins"),o.push("// Do not edit this file manually"),o.push(""),o.push('import "@vue/runtime-core";'),o.push(""),o.push("// GlobalComponents for Volar"),o.push('declare module "@vue/runtime-core" {'),o.push("	export interface GlobalComponents {"),l.forEach(({name:x,from:k})=>{let F=z(C.default.relative(a,k));F=F.replace(/\.(vue|tsx|jsx)$/,"");let T=F.startsWith(".")?F:`./${F}`;o.push(`		${x}: (typeof import("${T}"))["default"];`)}),o.push("	}"),o.push("}"),o.push(""),o.push("export {};");let y=`${o.join(`
`)}
`;S.default.existsSync(a)||S.default.mkdirSync(a,{recursive:!0});let P=S.default.existsSync(s)?S.default.readFileSync(s,"utf-8"):"";y!==P&&S.default.writeFileSync(s,y,"utf-8")};return{name:"fast-vite-plugin-component-auto-import",enforce:"post",configResolved:l=>{f=l},buildStart(){d(),h(),w()},configureServer(l){let s=C.default.resolve(f.root,e);if(S.default.existsSync(s)){l.watcher.add(s);let a=o=>{if(!o||o.endsWith(".d.ts"))return;let y=C.default.extname(o).slice(1);c.includes(y)&&(d(),h(),w())};l.watcher.on("add",a),l.watcher.on("change",a),l.watcher.on("unlink",a)}}}}var b=$(require("fs"),1),D=$(require("path"),1);function at(t){return t.replace(/[-_](\w)/g,(e,n)=>n?n.toUpperCase():"").replace(/^\w/,e=>e.toUpperCase())}function pt(t){let e=/defineOptions\(\s*\{\s*name:\s*["']([^"']+)["']/,n=t.match(e);return n?n[1]:null}function lt(t={}){let{dir:e="src/views",exportPath:n="src/router/index.json",deep:p=!0,extensions:r=["vue","tsx","jsx"],formatter:g}=t,c,m=(i,u=[])=>(b.default.existsSync(i)&&b.default.readdirSync(i).forEach(d=>{let h=D.default.join(i,d);if(b.default.statSync(h).isDirectory())p&&m(h,u);else{let l=D.default.extname(h).slice(1);r.includes(l)&&u.push(h)}}),u),f=()=>{let i=D.default.resolve(c.root,e),v=m(i).reduce((l,s)=>{try{let a=b.default.readFileSync(s,"utf-8"),o=pt(a),y=`/${D.default.relative(c.root,s).replace(/\\/g,"/")}`,P;if(o)P=o;else{let x=D.default.basename(s,D.default.extname(s));P=g?g(x):at(x)}l[y]=P}catch(a){console.error(`Error processing file ${s}:`,a)}return l},{}),d=D.default.resolve(c.root,n),h=D.default.dirname(d);b.default.existsSync(h)||b.default.mkdirSync(h,{recursive:!0});let w=JSON.stringify(v,null,2);b.default.writeFileSync(d,w,"utf-8")};return{name:"fast-vite-plugin-router-path",enforce:"post",configResolved:i=>{c=i},buildStart(){f()},configureServer(i){let u=D.default.resolve(c.root,e);if(b.default.existsSync(u)){i.watcher.add(u);let v=d=>{if(!d||d.endsWith(".d.ts")||d.endsWith(".json"))return;let h=D.default.extname(d).slice(1);r.includes(h)&&f()};i.watcher.on("add",v),i.watcher.on("change",v),i.watcher.on("unlink",v)}}}}var A=$(require("fs"),1),O=$(require("path"),1);function R(t,e=2){return t.toString().padStart(e,"0")}function ut(t){let e=t.getUTCFullYear(),n=R(t.getUTCMonth()+1),p=R(t.getUTCDate()),r=R(t.getUTCHours()),g=R(t.getUTCMinutes()),c=R(t.getUTCSeconds()),m=R(t.getUTCMilliseconds(),3);return`Z ${e}-${n}-${p} ${r}:${g}:${c}.${m}`}function mt(t){let e;return{name:"fast-vite-plugin-version-update",configResolved:n=>{e=n},buildStart(){let p=ut(new Date),r=e.publicDir,g=O.default.join(r,"version.json");A.default.existsSync(r)||A.default.mkdirSync(r);let c=JSON.stringify({version:`v${t}`,dateTime:p},null,4);A.default.writeFileSync(g,c);let m=O.default.join(e.base,"package.json");if(A.default.existsSync(m)){let f=JSON.parse(A.default.readFileSync(m,"utf-8"));f.version=t,A.default.writeFileSync(m,JSON.stringify(f,null,2),"utf-8")}}}}0&&(module.exports={buildRouterPath,buildSvgIcon,cdnImport,cdnJsDelivrUrl,cdnUnpkgUrl,componentAutoImport,findSvgFile,versionUpdatePlugin,writeTSXIcon});
//# sourceMappingURL=index.cjs.map