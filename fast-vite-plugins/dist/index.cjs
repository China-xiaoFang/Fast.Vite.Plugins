"use strict";var Y=Object.create;var T=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var X=Object.getOwnPropertyNames;var q=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var Q=(t,e)=>{for(var n in e)T(t,n,{get:e[n],enumerable:!0})},W=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of X(e))!K.call(t,r)&&r!==n&&T(t,r,{get:()=>e[r],enumerable:!(i=Z(e,r))||i.enumerable});return t};var w=(t,e,n)=>(n=t!=null?Y(q(t)):{},W(e||!t||!t.__esModule?T(n,"default",{value:t,enumerable:!0}):n,t)),tt=t=>W(T({},"__esModule",{value:!0}),t);var gt={};Q(gt,{buildRouterPath:()=>ut,buildSvgIcon:()=>et,cdnImport:()=>it,cdnJsDelivrUrl:()=>z,cdnUnpkgUrl:()=>st,componentAutoImport:()=>at,findSvgFile:()=>M,versionUpdatePlugin:()=>ft,writeTSXIcon:()=>J});module.exports=tt(gt);var R=w(require("fs"),1),j=w(require("path"),1),M=t=>{let e=[];return R.default.readdirSync(t,{withFileTypes:!0}).forEach(i=>{if(i.isDirectory())e.push(...M(j.default.join(t,i.name)));else{let r=i.name.replace(".svg",""),g=R.default.readFileSync(j.default.join(t,i.name),"utf-8").replace(/<\?xml.*?\?>/,"").replace(/<!DOCTYPE svg.*?>/,"").trimStart().trimEnd().replace(/<svg([^>+].*?)>/,(p,u)=>{let c=u.match(/viewBox="[^"]+"/),C=u.match(/width="(\d+)"/),a=u.match(/height="(\d+)"/),d=1024,h=1024;C&&(d=C[0]),a&&(h=a[0]);let f="";return c?f=c[0]:f=`viewBox="0 0 ${d} ${h}"`,`<svg xmlns="http://www.w3.org/2000/svg" ${f}>`});e.push({iconName:r,componentName:r.charAt(0).toUpperCase()+r.slice(1),iconContent:g})}}),e.sort((i,r)=>i.iconName<r.iconName?-1:i.iconName>r.iconName?1:0)},J=(t,e,n)=>{R.default.mkdirSync(e,{recursive:!0});let i=`import { defineComponent } from "vue";

/**
 * ${t} \u56FE\u6807\u7EC4\u4EF6
 */
export const ${t} = defineComponent({
	name: "${t}",
	render() {
		return (
${n.split(`
`).map(r=>`			${r}`).join(`
`)}
		);
	},
});

export default ${t};
`;R.default.writeFileSync(j.default.join(e,"index.tsx"),i)};function et(t,e){if(!t||!e)return;let n;return{name:"fast-vite-plugin-build-svg-icon",configResolved:i=>{n=i},buildStart(){let i=M(j.default.resolve(n.root,t)),r=j.default.resolve(n.root,e);R.default.mkdirSync(r,{recursive:!0});let g="",p="",u="";i.forEach((c,C)=>{J(c.componentName,j.default.join(r,c.iconName),c.iconContent),g+=`import { ${c.componentName} } from "./${c.iconName}";
`,p+=`	${c.componentName},`,u+=`export * from "./${c.iconName}";
`,C+1<i.length&&(p+=`
`)}),R.default.writeFileSync(j.default.join(r,"index.ts"),`import type { DefineComponent } from "vue";
${g}
${u}
export default [
${p}
] as unknown as DefineComponent[];
`)}}}var O=w(require("fs"),1),B=w(require("path"),1),V=w(require("rollup-plugin-external-globals"),1),G=require("vite-plugin-externals"),nt=process.env.NODE_ENV==="development";function ot(t){let e=process.cwd(),n=B.default.join(e,"node_modules",t,"package.json");return O.default.existsSync(n)?JSON.parse(O.default.readFileSync(n,"utf8")).version:""}function H(t){return!!(t.startsWith("http:")||t.startsWith("https:")||t.startsWith("//"))}function _(t,e){let{path:n}=e;return H(n)&&(t=n),t.replace(/\{name\}/g,e.name).replace(/\{version\}/g,e.version).replace(/\{path\}/g,n)}function rt(t,e){e=t.prodUrl||e;let n=t,i=t.version||ot(n.name),r=[];Array.isArray(n.path)?r=n.path:r.push(n.path);let g={...n,version:i};r=r.map(c=>{if(!i&&!H(c))throw new Error(`modules: ${g.name} package.json file does not exist`);return _(e,{name:g.name,version:g.version,path:c})});let p=n.css||[];!Array.isArray(p)&&p&&(p=[p]);let u=Array.isArray(p)?p.map(c=>_(e,{name:g.name,version:g.version,path:c})):[];return{...n,version:i,pathList:r,cssList:u}}var z="https://cdn.jsdelivr.net/npm/{name}@{version}/{path}",st="https://unpkg.com/{package}@{version}/{path}";function it(t){let{modules:e=[],prodUrl:n=z,enableInDevMode:i=!1,generateCssLinkTag:r,generateScriptTag:g}=t,p=!1,u=(Array.isArray(e)?e:[e]).map(a=>typeof a=="function"?a(n):a).map(a=>rt(a,n)),c={};u.forEach(a=>{c[a.name]=a.var,Array.isArray(a.alias)&&a.alias.forEach(d=>{c[d]=a.var})});let C=[{name:"fast-vite-plugin-cdn-import",enforce:"pre",config(a,{command:d}){p=d==="build";let h={build:{rollupOptions:{plugins:[]}}};return p&&(h.build.rollupOptions.plugins=[(0,V.default)(c)]),h},transformIndexHtml(a){if(!p&&!i)return a;let d=[];return u.forEach(h=>{h.pathList.forEach(f=>{let y=g?.(h.name,f)||{},N={src:f,crossorigin:"anonymous",...h?.attrs??{},...y.attrs};d.push({tag:"script",attrs:N,...y})}),h.cssList.forEach(f=>{let y=r?.(h.name,f)||{},N={href:f,rel:"stylesheet",crossorigin:"anonymous",...h?.attrs??{},...y.attrs};d.push({tag:"link",attrs:N,...y})})}),d}}];return nt&&i&&C.push((0,G.viteExternalsPlugin)(c,{enforce:"pre"})),C}var S=w(require("fs"),1),$=w(require("path"),1);function L(t){return t.replace(/\\/g,"/")}function ct(t){return t.replace(/[-_](\w)/g,(e,n)=>n?n.toUpperCase():"").replace(/^\w/,e=>e.toUpperCase())}function at(t={}){let{dir:e="src/components",exportPath:n="src/components/index.ts",dts:i=!0,dtsPath:r="types/component.d.ts",deep:g=!0,extensions:p=["vue","tsx","jsx"],formatter:u}=t,c,C=new Map,a=null,d=m=>{let s=m;for(let l of p)if(s.endsWith(`.${l}`)){s=s.slice(0,-l.length-1);break}if(s.endsWith("/index")||s.endsWith("\\index")){let l=s.split(/[\\/]/);s=l[l.length-2]||l[l.length-1]}else{let l=s.split(/[\\/]/);s=l[l.length-1]}return u?u(s):ct(s)},h=(m,s=0)=>{let l=[];if(!S.default.existsSync(m))return l;let o=S.default.readdirSync(m,{withFileTypes:!0});for(let v of o){let D=$.default.join(m,v.name);if(v.isDirectory()){if(v.name==="node_modules"||v.name.startsWith(". "))continue;(g||s===0)&&l.push(...h(D,s+1))}else if(v.isFile()){let x=$.default.extname(v.name).slice(1);p.includes(x)&&l.push(D)}}return l},f=()=>{C.clear();let m=$.default.resolve(c.root,e);if(!S.default.existsSync(m)){console.warn(`[component-auto-import] Directory not found: ${m}`);return}h(m).forEach(l=>{let o=$.default.relative(m,l),v=d(o);C.set(v,{name:v,from:l})})},y=()=>{if(C.size===0)return;let m=Array.from(C.values()).sort((x,A)=>x.name.localeCompare(A.name)),s=$.default.resolve(c.root,n),l=$.default.dirname(s),o=[];o.push("/* eslint-disable */"),o.push("/* prettier-ignore */"),o.push("// @ts-nocheck"),o.push("// Auto-generated by fast component-auto-import"),o.push("// Generated by fast-vite-plugins"),o.push("// Do not edit this file manually"),o.push(""),o.push('import type { App } from "vue";'),o.push(""),m.forEach(({name:x,from:A})=>{let b=L($.default.relative(l,A)),U=b.startsWith(".")?b:`./${b}`;o.push(`import ${x} from "${U}";`),o.push(`export { ${x} };`),o.push(`export type ${x}Instance = InstanceType<typeof ${x}>;`)}),o.push(""),o.push("/** \u81EA\u52A8\u6CE8\u518C\u6240\u6709\u7EC4\u4EF6 */"),o.push("export function registerComponents(app: App): void {"),m.forEach(({name:x})=>{o.push(`	app.component(${x}.name, ${x});`)}),o.push("}"),o.push("");let v=`${o.join(`
`)}
`,D=S.default.existsSync(s)?S.default.readFileSync(s,"utf-8"):"";v!==D&&S.default.writeFileSync(s,v,"utf-8")},N=()=>{if(!i||C.size===0)return;let m=Array.from(C.values()).sort((x,A)=>x.name.localeCompare(A.name)),s=$.default.resolve(c.root,r),l=$.default.dirname(s),o=[];o.push("// For this project development"),o.push("// Auto-generated by fast component-auto-import"),o.push("// Generated by fast-vite-plugins"),o.push("// Do not edit this file manually"),o.push(""),o.push('import "@vue/runtime-core";'),o.push(""),o.push("// GlobalComponents for Volar"),o.push('declare module "@vue/runtime-core" {'),o.push("	export interface GlobalComponents {"),m.forEach(({name:x,from:A})=>{let b=L($.default.relative(l,A));b=b.replace(/\.(vue|tsx|jsx)$/,"");let U=b.startsWith(".")?b:`./${b}`;o.push(`		${x}: (typeof import("${U}"))["default"];`)}),o.push("	}"),o.push("}"),o.push(""),o.push("export {};");let v=`${o.join(`
`)}
`;S.default.existsSync(l)||S.default.mkdirSync(l,{recursive:!0});let D=S.default.existsSync(s)?S.default.readFileSync(s,"utf-8"):"";v!==D&&S.default.writeFileSync(s,v,"utf-8")};return{name:"fast-vite-plugin-component-auto-import",enforce:"post",configResolved:m=>{c=m},buildStart(){f(),y(),N()},configureServer(m){let s=$.default.resolve(c.root,e);S.default.existsSync(s)&&(a=S.default.watch(s,{recursive:!0},(l,o)=>{if(!o||o.endsWith(".d.ts"))return;let v=$.default.extname(o).slice(1);p.includes(v)&&(f(),y(),N(),m.ws.send({type:"full-reload",path:"*"}))}))},buildEnd(){a&&(a.close(),a=null)}}}var F=w(require("fs"),1),P=w(require("path"),1);function pt(t){return t.replace(/[-_](\w)/g,(e,n)=>n?n.toUpperCase():"").replace(/^\w/,e=>e.toUpperCase())}function lt(t){let e=/defineOptions\(\s*\{\s*name:\s*["']([^"']+)["']/,n=t.match(e);return n?n[1]:null}function ut(t={}){let{dir:e="src/views",exportPath:n="src/router/index.json",deep:i=!0,extensions:r=["vue","tsx","jsx"],formatter:g}=t,p,u=null,c=(a,d=[])=>(F.default.existsSync(a)&&F.default.readdirSync(a).forEach(f=>{let y=P.default.join(a,f);if(F.default.statSync(y).isDirectory())i&&c(y,d);else{let m=P.default.extname(y).slice(1);r.includes(m)&&d.push(y)}}),d),C=()=>{let a=P.default.resolve(p.root,e),h=c(a).reduce((m,s)=>{try{let l=F.default.readFileSync(s,"utf-8"),o=lt(l),v=`/${P.default.relative(p.root,s).replace(/\\/g,"/")}`,D;if(o)D=o;else{let x=P.default.basename(s,P.default.extname(s));D=g?g(x):pt(x)}m[v]=D}catch(l){console.error(`Error processing file ${s}:`,l)}return m},{}),f=P.default.resolve(p.root,n),y=P.default.dirname(f);F.default.existsSync(y)||F.default.mkdirSync(y,{recursive:!0});let N=JSON.stringify(h,null,2);F.default.writeFileSync(f,N,"utf-8")};return{name:"fast-vite-plugin-router-path",enforce:"post",configResolved:a=>{p=a},buildStart(){C()},configureServer(a){let d=P.default.resolve(p.root,e);F.default.existsSync(d)&&(u=F.default.watch(d,{recursive:!0},(h,f)=>{if(!f||f.endsWith(".d.ts")||f.endsWith(".json"))return;let y=P.default.extname(f).slice(1);r.includes(y)&&(C(),a.ws.send({type:"full-reload",path:"*"}))}))},buildEnd(){u&&(u.close(),u=null)}}}var k=w(require("fs"),1),I=w(require("path"),1);function E(t,e=2){return t.toString().padStart(e,"0")}function mt(t){let e=t.getUTCFullYear(),n=E(t.getUTCMonth()+1),i=E(t.getUTCDate()),r=E(t.getUTCHours()),g=E(t.getUTCMinutes()),p=E(t.getUTCSeconds()),u=E(t.getUTCMilliseconds(),3);return`Z ${e}-${n}-${i} ${r}:${g}:${p}.${u}`}function ft(t){let e;return{name:"fast-vite-plugin-version-update",configResolved:n=>{e=n},buildStart(){let i=mt(new Date),r=e.publicDir,g=I.default.join(r,"version.json");k.default.existsSync(r)||k.default.mkdirSync(r);let p=JSON.stringify({version:`v${t}`,dateTime:i},null,4);k.default.writeFileSync(g,p);let u=I.default.join(e.base,"package.json");if(k.default.existsSync(u)){let c=JSON.parse(k.default.readFileSync(u,"utf-8"));c.version=t,k.default.writeFileSync(u,JSON.stringify(c,null,2),"utf-8")}}}}0&&(module.exports={buildRouterPath,buildSvgIcon,cdnImport,cdnJsDelivrUrl,cdnUnpkgUrl,componentAutoImport,findSvgFile,versionUpdatePlugin,writeTSXIcon});
//# sourceMappingURL=index.cjs.map